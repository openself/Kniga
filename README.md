

**КНИГА АРТЕМА ГРУЗДЕВА "ПРОГНОЗНОЕ МОДЕЛИРОВАНИЕ В IBM SPSS STATISTICS, R И PYTHON. МЕТОД ДЕРЕВЬЕВ РЕШЕНИЙ И СЛУЧАЙНЫЙ ЛЕС"**
----------------------------------------------------
![enter image description here](https://lh3.googleusercontent.com/-AAdAtC3CbwU/WmdbzzjopxI/AAAAAAAAALQ/kMnt7yFAZOYDNSbPrEXCiX3ybESNyTuYgCLcBGAs/s0/RandomForest.png "RandomForest.png")

Данная книга открывает серию пособий, посвященных практическому применению методов машинного обучения на базе популярных статистических пакетов IBM SPSS Statistics и R. В первом выпуске освещаются методы деревьев решений и случайного леса. Деревья решений – это эффективный метод машинного обучения, использующийся в прогнозном моделировании. Кроме того, при решении задач бинарной классификации он нередко дополняет метод логистической регрессии. Аналитики
кредитного бюро TransUnion для построения скоринговых моделей используют логистическую регрессию, а для отбора переменных в модель логистической регрессии (рассматриваются сотни переменных) – деревья решений. Наша компания при построении прогнозных моделей на основе логистической регрессии использует метод деревьев решений, чтобы сформировать новые переменные для лучшего прогнозирования дефолта. Аналитики Citibank USA разбивают популяцию заемщиков на сегменты, применяя дерево решений, а затем в каждом сегменте строят модели доходности с помощью линейной регрессии или модели риска с помощью логистической регрессии. Итогом развития метода деревьев решений стал случайный лес, который является на сегодняшний день одним из популярнейших методов машинного обучения. Он представляет собой комитет деревьев решений и за счет использования
рандомизации и усреднения позволяет получить более точные прогнозы.

**О содержании книги** 

В этой книге я детально расскажу о том, как строить модели дерева решений или модели случайного леса, интерпретировать результаты, оценивать качество полученных моделей, улучшать его, сохранять результаты и применять правила классификации/прогноза, полученные с помощью дерева или случайного леса, к новым данным. Также я расскажу о том, как с помощью дерева решений и случайного леса улучшить модель логистической регрессии. Отдельно рассматривается вопрос автоматизированного поиска оптимальных параметров случайного леса.

Глава 1 кратко знакомит с терминологией метода деревьев решений, в ней рассказывается о преимуществах и недостатках деревьев, задачах, которые можно выполнить с их помощью.

Главы 2–6 посвящены построению деревьев решений и случайного леса в IBM SPSS Statistics 24.0. 

В главе 2 освещается CHAID – один из самых популярных методов деревьев решений. 

В главе 3 я покажу, как можно менять параметры дерева CHAID, влияя на результаты классификации. Здесь же я расскажу о том, как можно выполнить биннинг переменных для включения в модель логистической регрессии, использовав дерево решений CHAID и случайный лес. Для иллюстрации выбрана конкурсная задача предсказания отклика ОТП Банка. Кроме того, на данном примере я покажу, как выполняется
предварительная подготовка данных и решаются вопросы, связанные с автоматизацией построения моделей (для этого будет использован командный синтаксис SPSS). Код, автоматизирующий процесс построения прогнозных моделей, вы можете в дальнейшем использовать в собственных проектах. В этой же главе будет рассмотрена разработка ансамбля модели логистической регрессии и дерева CHAID. 

Глава 4 посвящена методам деревьев CRT и QUEST. 

В главе 5 рассказывается о редакторе дерева. 

Глава 6 посвящена методу случайного леса. В ней я расскажу о методологической основе случайного леса,
приведу примеры использования случайного леса для решения задач классификации и регрессии, покажу, как применять модель случайного леса к новым данным.

Главы 7–11 посвящены построению деревьев решений и случайного леса в R.

В [главе 7](https://github.com/Gewissta/Kniga/blob/master/Programming%20code%20R%20and%20Python/%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2007_%D0%9F%D0%BE%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D1%8C%D0%B5%D0%B2%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B9%20CHAID%20%D1%81%20%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E%20%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0%20R%20CHAID.R) я подробно рассмотрю процесс построения и интерпретации дерева решений CHAID в пакете CHAID. 

В [главе 8](https://github.com/Gewissta/Kniga/blob/master/Programming%20code%20R%20and%20Python/%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2008_%D0%9F%D0%BE%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D1%8C%D0%B5%D0%B2%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B9%20CRT%20%D1%81%20%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E%20%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0%20R%20rpart.R) я применю пакет rpart, чтобы построить и проанализировать дерево решений CRT. 

В [главе 9](https://github.com/Gewissta/Kniga/blob/master/Programming%20code%20R%20and%20Python/%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2009_%20%D0%9F%D0%BE%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BD%D0%B8%D0%B5%20%D1%81%D0%BB%D1%83%D1%87%D0%B0%D0%B9%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%BB%D0%B5%D1%81%D0%B0%20%D1%81%20%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E%20%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0%20R%20randomForest.R) я покажу, как можно построить модель случайного леса, интерпретировать ее и применить к новым данным, используя пакет randomForest. В ней же будет рассказано как осуществлять оптимизацию
параметров случайного леса с помощью пакета caret. 

[Глава 10](https://github.com/Gewissta/Kniga/blob/master/Programming%20code%20R%20and%20Python/%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2010_%D0%9F%D0%BE%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BD%D0%B8%D0%B5%20%D1%81%D0%BB%D1%83%D1%87%D0%B0%D0%B9%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%BB%D0%B5%D1%81%D0%B0%20%D1%81%20%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E%20%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0%20R%20ranger.R) посвящена пакету ranger – быстрой реализации случайного леса в R, позволяющей работать с большими и высокоразмерными наборами данных. Кроме того, в этом пакете реализована возможность использовать случайный лес не только для решения задач регрессии и классификации, но и для анализа выживаемости. 

В [главе 11](https://github.com/Gewissta/Kniga/blob/master/Programming%20code%20R%20and%20Python/%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2011_%D0%9F%D0%BE%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BD%D0%B8%D0%B5%20%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE%20%D1%81%D0%BB%D1%83%D1%87%D0%B0%D0%B9%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%BB%D0%B5%D1%81%D0%B0%20%D1%81%20%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E%20%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0%20R%20h2o.R) я расскажу о пакете h2o, который позволяет использовать в среде R возможности платформы H2O, разработанной для работы с большими данными. Речь пойдет об алгоритме случайного леса,
использующего распределенные вычисления и новейшие эвристики, позволяющие в ряде случаев получить лучшее качество модели.

В [главе 12](https://github.com/Gewissta/Kniga/blob/master/Programming%20code%20R%20and%20Python/%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2012_%D0%9F%D0%BE%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BD%D0%B8%D0%B5%20%D1%81%D0%BB%D1%83%D1%87%D0%B0%D0%B9%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%BB%D0%B5%D1%81%D0%B0%20%D1%81%20%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E%20Python.ipynb) речь пойдет об использовании классов DecisionTreeClassifer, DecisionTreeRegressor, RandomForestClassifer и RandomForestRegressor, реализованных в питоновской библиотеке scikit­learn и предназначенных для построения дерева классификации, дерева регрессии, ансамбля деревьев классификации и ансамбля деревьев регрессии соответственно. В этой же главе будет рассмотрена работа c питоновским модулем h2o и построение распределенного случайного леса c помощью класса
H2ORandomForestEstimator.

В приложениях [1](https://github.com/Gewissta/Kniga/blob/master/Programming%20code%20R%20and%20Python/%D0%9F%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5%201_%D0%9F%D1%80%D0%B5%D0%B4%D0%B2%D0%B0%D1%80%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F%20%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%20%D0%B2%20Python%20%D1%81%20%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E%20pandas.ipynb) и [2](https://github.com/Gewissta/Kniga/blob/master/Programming%20code%20R%20and%20Python/%D0%9F%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5%202_%D0%9F%D1%80%D0%B5%D0%B4%D0%B2%D0%B0%D1%80%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F%20%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%20%D0%B2%20R.R) дается обзор различных операций по предварительной подготовке данных в Python и R соответственно (создание новых переменных, импутация пропущенных значений, работа со строками и т. д.). Они представляют собой примеры, следующие в строгой последовательности, и предназначены для методического выполнения, чтобы помочь вам сформировать базовые навыки по подготовке данных, именно на нее аналитики тратят до 80% своего рабочего времени. 

В [приложении 3](https://github.com/Gewissta/Kniga/blob/master/Programming%20code%20R%20and%20Python/%D0%9F%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5%203_%D0%92%D0%B8%D0%B7%D1%83%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%20%D0%B2%20Python.ipynb) дается обзор возможностей визуализации данных в Python.

[Приложение 4](https://github.com/Gewissta/Kniga/blob/master/Programming%20code%20R%20and%20Python/%D0%9F%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5%204_%D0%9F%D0%BE%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BD%D0%B8%D0%B5%20ROC-%D0%BA%D1%80%D0%B8%D0%B2%D0%BE%D0%B9%20%D0%B8%20%D0%B2%D1%8B%D1%87%D0%B8%D1%81%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%20AUC.R) посвящено построению ROC-кривой и вычислению AUC вручную для лучшего понимания этих метрик.

[Приложение 5](https://github.com/Gewissta/Kniga/blob/master/Programming%20code%20R%20and%20Python/%D0%9F%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5%205_%D0%94%D0%B5%D0%BA%D0%BE%D0%BC%D0%BF%D0%BE%D0%B7%D0%B8%D1%86%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D0%B3%D0%BD%D0%BE%D0%B7%D0%BE%D0%B2%20%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D0%B0%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B9%20%D0%B8%20%D1%81%D0%BB%D1%83%D1%87%D0%B0%D0%B9%D0%BD%D0%BE%D0%B3%D0%BE%20%D0%BB%D0%B5%D1%81%D0%B0.ipynb) посвящено питоновскому пакету treeinterpreter, с помощью которого можно "объяснить" прогнозы случайного леса. 